Metadata-Version: 2.4
Name: diy-whisperpair
Version: 0.1.0
Summary: Google Fast Pair Seeker implementation for security research (CVE-2025-36911)
Author-email: Security Researcher <research@example.com>
License: MIT
Project-URL: Homepage, https://github.com/example/diy-whisperpair
Project-URL: Documentation, https://github.com/example/diy-whisperpair#readme
Keywords: bluetooth,ble,fast-pair,security,research
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Security
Classifier: Topic :: Scientific/Engineering
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: bleak>=0.22.0
Requires-Dist: cryptography>=42.0.0
Requires-Dist: pycryptodome>=3.20.0
Requires-Dist: click>=8.1.0
Requires-Dist: rich>=13.7.0
Provides-Extra: dev
Requires-Dist: pytest>=8.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.23.0; extra == "dev"
Requires-Dist: black; extra == "dev"
Requires-Dist: ruff; extra == "dev"
Dynamic: license-file

# DIY-WhisperPair

**CVE-2025-36911 Reference Implementation for Security Researchers**

[![Research](https://img.shields.io/badge/Type-Security%20Research-blue)](https://whisperpair.eu)
[![CVE](https://img.shields.io/badge/CVE-2025--36911-red)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-36911)
[![Status](https://img.shields.io/badge/Disclosure-Completed-green)](https://whisperpair.eu)

> **LEGAL NOTICE**: This is a security research tool. **Read [LEGAL.md](LEGAL.md) before use.** Unauthorized access to computer systems is a criminal offence.

---

## Quick Start

```bash
# Install
git clone https://github.com/SpectrixDev/DIY-WhisperPair.git
cd DIY-WhisperPair
pip install -e .

# Run interactive CLI
whisperpair
```

This launches an interactive menu:

```
╦ ╦╦ ╦╦╔═╗╔═╗╔═╗╦═╗╔═╗╔═╗╦╦═╗
║║║╠═╣║╚═╗╠═╝║╣ ╠╦╝╠═╝╠═╣║╠╦╝
╚╩╝╩ ╩╩╚═╝╩  ╚═╝╩╚═╩  ╩ ╩╩╩╚═

────────────── Main Menu ──────────────

  1  Scan      Discover Fast Pair devices nearby
  2  Verify    Test device vulnerability (requires authorization)
  3  Info      Get detailed device information
  4  Learn     Understand CVE-2025-36911
  5  Demo      View verification walkthrough
  0  Exit      Quit the application

Select option [1]:
```

---

## For Researchers: Python API

This library is designed to be **easily extensible**. Import what you need:

### Simple Functions

```python
import asyncio
from whisperpair import scan_devices, verify_device, get_device_info

# Scan for Fast Pair devices
devices = asyncio.run(scan_devices(timeout=10))
for d in devices:
    print(f"{d.address} - {d.name} - Risk: {'HIGH' if not d.is_in_pairing_mode else 'Low'}")

# Find only vulnerable devices (not in pairing mode)
vulnerable = asyncio.run(scan_devices(vulnerable_only=True))

# Verify a specific device (REQUIRES AUTHORIZATION)
result = asyncio.run(verify_device("AA:BB:CC:DD:EE:FF"))
if result.success:
    print(f"VULNERABLE - Provider: {result.provider_address}")

# Get device info
info = asyncio.run(get_device_info("AA:BB:CC:DD:EE:FF"))
print(f"Model: {info['model_name']}")
```

### Building Custom Tools

```python
from whisperpair import (
    # Scanner
    FastPairScanner,
    FastPairDevice,
    
    # Client  
    FastPairClient,
    VerificationResult,
    
    # Protocol
    KeyBasedPairingRequest,
    KeyBasedPairingResponse,
    PairingRequestFlags,
    parse_bluetooth_address,
    
    # Crypto
    FastPairCrypto,
    aes_128_encrypt,
    aes_128_decrypt,
    generate_account_key,
    
    # Constants
    FAST_PAIR_SERVICE_UUID,
    KEY_BASED_PAIRING_CHAR_UUID,
    KNOWN_MODEL_IDS,
)

# Custom scanner with callbacks
def on_found(device: FastPairDevice):
    if not device.is_in_pairing_mode:
        print(f"[!] Potential target: {device.address}")

scanner = FastPairScanner(timeout=15, on_device_found=on_found)
asyncio.run(scanner.scan())

# Build raw protocol packets
target_bytes = parse_bluetooth_address("AA:BB:CC:DD:EE:FF")
request = KeyBasedPairingRequest.for_verification(provider_address=target_bytes)
packet = request.build()  # 16-byte plaintext
encrypted = aes_128_encrypt(your_key, packet)

# Full custom flow
async with FastPairClient("AA:BB:CC:DD:EE:FF") as client:
    model_id = await client.read_model_id()
    result = await client.verify_pairing_behavior(aes_key=your_key)
```

### Example Scripts

See [`examples.py`](examples.py) for 8 copy-paste ready examples:

```bash
python examples.py --example scan          # Basic scanning
python examples.py --example vulnerable    # Find vulnerable devices
python examples.py --example verify -t AA:BB:CC:DD:EE:FF
python examples.py --example protocol      # Build raw packets
python examples.py --example crypto        # ECDH & AES operations
```

---

## CLI Commands

### Interactive Mode (Default)
```bash
whisperpair
```

### Direct Commands
```bash
# Scan for devices
whisperpair scan
whisperpair scan --vulnerable
whisperpair scan --timeout 15

# Get device info
whisperpair info AA:BB:CC:DD:EE:FF

# Verify vulnerability (requires flags)
whisperpair verify AA:BB:CC:DD:EE:FF --authorized

# Learn about the vulnerability
whisperpair learn

# View walkthrough
whisperpair demo
```

---

## Legal Requirements

### You MUST Have Authorization

This tool performs active Bluetooth operations. **Before running any verification commands**, you must have:

1. **Written permission** from the device owner, OR
2. **Own the device** yourself

### Jurisdiction-Specific Laws

| Jurisdiction | Relevant Law |
|--------------|--------------|
| **UK** | Computer Misuse Act 1990, Section 1-3A |
| **US** | Computer Fraud and Abuse Act (CFAA) |
| **EU** | Directive 2013/40/EU |
| **Germany** | § 202a-c StGB |
| **Australia** | Criminal Code Act 1995, Part 10.7 |

**See [LEGAL.md](LEGAL.md) for detailed guidance.**

---

## The Vulnerability (CVE-2025-36911)

### The Flaw

Google Fast Pair requires devices to **only accept pairing requests when in pairing mode**. Many devices fail this check:

```
EXPECTED: Device checks "Am I in pairing mode?" → NO → Reject
ACTUAL:   Device accepts request regardless of mode state
```

### Impact

An attacker within Bluetooth range (~10-14m) can:
- **Play audio** through victim's headphones
- **Access microphone** for surveillance  
- **Track location** via Google Find Hub

### Affected Devices (Pre-Patch)

| Manufacturer | Devices |
|--------------|---------|
| Google | Pixel Buds Pro 2 |
| Sony | WF-1000XM4, WH-1000XM5, LinkBuds S |
| JBL | Tune Buds, Live Pro 2 |
| Anker | Soundcore Liberty 4 |
| Others | See [whisperpair.eu](https://whisperpair.eu) |

---

## Project Structure

```
DIY_WhisperPair/
├── src/whisperpair/
│   ├── __init__.py      # Public API exports
│   ├── scanner.py       # BLE device discovery
│   ├── client.py        # GATT client & verification
│   ├── protocol.py      # Packet builders
│   ├── crypto.py        # AES-128, ECDH, keys
│   ├── constants.py     # UUIDs, Model IDs
│   └── cli.py           # Interactive CLI
├── examples.py          # Copy-paste code snippets
├── security_demo.py     # Standalone verification demo
├── LEGAL.md
└── README.md
```

---

## Installation

```bash
git clone https://github.com/SpectrixDev/DIY-WhisperPair.git
cd DIY-WhisperPair
python3 -m venv venv
source venv/bin/activate  # Linux/macOS
pip install -e .
```

### Requirements

- Python 3.10+
- Bluetooth adapter with BLE support
- Linux: BlueZ 5.50+
- Windows: Windows 10 1703+
- macOS: macOS 10.13+

---

## References

### Original Research
- **Website**: [whisperpair.eu](https://whisperpair.eu)
- **CVE**: [CVE-2025-36911](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-36911)
- **Paper**: "WhisperPair: Hijacking Bluetooth Accessories Using Google Fast Pair"
- **Authors**: KU Leuven DistriNet (Duttagupta, Antonijević, Preneel, Wyns, Singelée)

### Technical Docs
- [Google Fast Pair Spec](https://developers.google.com/nearby/fast-pair/specifications/introduction)
- [Key-based Pairing Protocol](https://developers.google.com/nearby/fast-pair/specifications/characteristics#key-based_pairing)

### Video
[![One Tap to Hijack Them All](https://img.youtube.com/vi/-j45ShJINtc/0.jpg)](https://www.youtube.com/watch?v=-j45ShJINtc)

---

## Responsible Use

This tool is provided **solely** for:
- Security research and vulnerability verification
- Authorized penetration testing
- Device manufacturer validation
- Educational purposes

**NOT for**: Unauthorized access, harassment, surveillance, or any illegal activity.

---

## License

MIT License - See [LICENSE](LICENSE)

---

## Acknowledgments

- **KU Leuven DistriNet** - Original research
- **Google Android Security Team** - Coordinated disclosure
- **Seytonic** - [Excellent explainer video](https://www.youtube.com/watch?v=Ux07J-wS2VA)
